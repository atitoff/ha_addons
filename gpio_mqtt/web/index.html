<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- The page supports both dark and light color schemes,
         and the page author prefers / default is light. -->
    <meta name="color-scheme" content="light dark">

    <!-- Replace the Bootstrap CSS with the
         Bootstrap-Dark Variant CSS -->
    <link href="static/js/bootstrap-dark.min.css" rel="stylesheet">

    <title></title>

    <!-- Optional Meta Theme Color is also supported on Safari and Chrome -->
    <meta name="theme-color" content="#111111" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#eeeeee" media="(prefers-color-scheme: dark)">
</head>
<body style="margin: 1em">


<button id="find_new_lamp_dali" type="button" class="btn btn-primary">
    <span id="find_new_lamp_dali_spinner" class="d-none spinner-border spinner-border-sm" role="status"
          aria-hidden="true"></span>
    Поиск нового светильника DALI
</button>

<!-- Optional Bootstrap JavaScript -->
<script src="static/js/bootstrap.bundle.min.js"></script>
<script src="static/js/main.js"></script>
<script src="static/js/simple-jsonrpc-js.min.js"></script>
<script>
    let jrpc = simple_jsonrpc.connect_xhr('/rpc');

    window.onload = async function () {
        fw2fn.init()
        console.log('location.hostname', location.hostname)
        console.log('document.referrer', document.referrer)

        await fetch(`${document.referrer}/rpc` + encodeURIComponent(
            JSON.stringify({jsonrpc: "2.0", method: "findNewLampDali", id: 4, params: {a: 2, b: 3}})
        ), {
            method: 'GET',
            headers: {
                'Content-type': 'application/json; charset=UTF-8' // The type of data you're sending
            }
        });


    }

    document.getElementById('find_new_lamp_dali').onclick = async function () {
        let spinner = document.getElementById("find_new_lamp_dali_spinner")
        spinner.classList.remove('d-none')
        fw2fn.disable_elements()
        await fetch(`${document.referrer}/rpc` + encodeURIComponent(
            JSON.stringify({jsonrpc: "2.0", method: "findNewLampDali", id: 4, params: {a: 2, b: 3}})
        ), {
            method: 'GET',
            headers: {
                'Content-type': 'application/json; charset=UTF-8' // The type of data you're sending
            }
        });
        console.log(a)
        spinner.classList.add('d-none')
        fw2fn.disable_elements(false)
    }
</script>
</body>
</html>