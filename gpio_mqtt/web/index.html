<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- The page supports both dark and light color schemes,
         and the page author prefers / default is light. -->
    <meta name="color-scheme" content="light dark">

    <!-- Replace the Bootstrap CSS with the
         Bootstrap-Dark Variant CSS -->
    <link href="static/js/bootstrap-dark.min.css" rel="stylesheet">

    <title></title>

    <!-- Optional Meta Theme Color is also supported on Safari and Chrome -->
    <meta name="theme-color" content="#111111" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#eeeeee" media="(prefers-color-scheme: dark)">
</head>
<body style="margin: 1em">



<button id="find_new_lamp_dali" type="button" class="btn btn-primary">
    <span id="find_new_lamp_dali_spinner" class="d-none spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
    Поиск нового светильника DALI
</button>

<!-- Optional Bootstrap JavaScript -->
<script src="static/js/bootstrap.bundle.min.js"></script>
<script src="static/js/main.js"></script>
<script src="static/js/mqtt.js"></script>
<script>
    let fw = new FW2('ws', "{{ .Token}}", 600)

    window.onload = async function () {
        fw2fn.init()
        await fw.init()
        console.log("connected")
        fw.notify.addEventListener('asa', (e) => {
            let params = e.detail
            console.log('asa', params)
        })

    }

    async function run() {
        await fw.call_rpc('MyFunc1', {'update': 1})
    }

    document.getElementById('find_new_lamp_dali').onclick = async function (){
        let spinner = document.getElementById("find_new_lamp_dali_spinner")
        spinner.classList.remove('d-none')
        fw2fn.disable_elements()
        console.log(await fw.call_rpc('findNewLampDali', {'update': 1}))
        spinner.classList.add('d-none')
        fw2fn.disable_elements(false)
    }
</script>
</body>
</html>